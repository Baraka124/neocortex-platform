// editor.js
class MarkdownEditor {
    constructor() {
        this.input = document.getElementById('markdown-input');
        this.preview = document.getElementById('markdown-preview');
        this.setupEventListeners();
        this.loadSavedContent();
    }

    setupEventListeners() {
        this.input.addEventListener('input', () => {
            this.updatePreview();
            this.saveContent();
        });
    }

    updatePreview() {
        const markdown = this.input.value;
        const html = this.convertMarkdown(markdown);
        this.preview.innerHTML = html;
    }

    convertMarkdown(text) {
        return text
            .replace(/^# (.*$)/gm, '<h1>$1</h1>')
            .replace(/^## (.*$)/gm, '<h2>$1</h2>')
            .replace(/^### (.*$)/gm, '<h3>$1</h3>')
            .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
            .replace(/\*(.*?)\*/g, '<em>$1</em>')
            .replace(/`([^`]+)`/g, '<code>$1</code>')
            .replace(/!\[([^\]]*)\]\(([^)]+)\)/g, '<img alt="$1" src="$2">')
            .replace(/\[([^\]]+)\]\(([^)]+)\)/g, '<a href="$2">$1</a>')
            .replace(/\n/g, '<br>');
    }

    saveContent() {
        localStorage.setItem('markdown-content', this.input.value);
    }

    loadSavedContent() {
        const saved = localStorage.getItem('markdown-content');
        if (saved) {
            this.input.value = saved;
            this.updatePreview();
        }
    }
}

// Initialize when page loads
window.addEventListener('DOMContentLoaded', () => {
    new MarkdownEditor();
});
